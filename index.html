<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>KHATA PRO V24 - STORAGE RESET</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-white p-6">

    <div class="max-w-md mx-auto">
        <h1 class="text-2xl font-black text-center text-blue-500 mb-5">KHATA PRO V24</h1>
        
        <div class="bg-slate-800 p-6 rounded-3xl shadow-xl">
            <input type="text" id="name" class="w-full p-4 mb-3 bg-slate-900 rounded-xl outline-none" placeholder="Customer Name">
            <input type="number" id="phone" class="w-full p-4 mb-4 bg-slate-900 rounded-xl outline-none" placeholder="Phone Number">
            
            <button onclick="saveData()" class="w-full p-5 bg-blue-600 rounded-2xl font-bold active:scale-95 transition-transform mb-3">
                SAVE CUSTOMER
            </button>

            <button onclick="resetApp()" class="w-full p-2 text-[10px] text-red-500 opacity-50 uppercase font-bold">
                Reset App & Clear Errors
            </button>
        </div>

        <div id="list" class="mt-8 space-y-2"></div>
    </div>

    <script>
        // തികച്ചും പുതിയ ഒരു മെമ്മറി കീ ഉപയോഗിക്കുന്നു
        const DB_KEY = 'KHATA_FINAL_STORAGE_V24';

        function render() {
            const list = document.getElementById('list');
            try {
                const data = JSON.parse(localStorage.getItem(DB_KEY)) || [];
                list.innerHTML = data.length > 0 ? '' : '<p class="text-center opacity-20">No data</p>';
                data.forEach((item, idx) => {
                    list.innerHTML += `
                        <div class="bg-slate-800 p-4 rounded-xl flex justify-between items-center border-l-4 border-blue-500">
                            <b>${item.name}</b>
                            <span class="opacity-50">${item.phone}</span>
                        </div>`;
                });
            } catch(e) {
                list.innerHTML = '<p class="text-red-500">Storage Error. Please Reset.</p>';
            }
        }

        function saveData() {
            const n = document.getElementById('name').value.trim();
            const p = document.getElementById('phone').value.trim();

            if(!n) { alert("Please enter a name!"); return; }

            try {
                let data = JSON.parse(localStorage.getItem(DB_KEY)) || [];
                data.push({name: n, phone: p});
                localStorage.setItem(DB_KEY, JSON.stringify(data));
                
                document.getElementById('name').value = '';
                document.getElementById('phone').value = '';
                render();
                alert("Saved: " + n);
            } catch(e) {
                alert("Still Error! Please click 'RESET APP' button below.");
            }
        }

        function resetApp() {
            if(confirm("This will clear all saved data and fix the error. Continue?")) {
                localStorage.clear();
                location.reload();
            }
        }

        window.onload = render;
    </script>
</body>
</html>