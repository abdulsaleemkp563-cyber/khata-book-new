<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>KHATA PRO V23 - DEBUG MODE</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-white p-6">

    <div class="max-w-md mx-auto">
        <h1 class="text-2xl font-black text-center text-blue-500 mb-2">KHATA PRO V23</h1>
        <p id="debug_msg" class="text-[10px] text-center text-yellow-500 mb-5">Checking Storage...</p>
        
        <div class="bg-slate-800 p-6 rounded-3xl shadow-xl">
            <input type="text" id="name" class="w-full p-4 mb-3 bg-slate-900 rounded-xl outline-none" placeholder="Name">
            <input type="number" id="phone" class="w-full p-4 mb-4 bg-slate-900 rounded-xl outline-none" placeholder="Phone">
            
            <button onclick="saveNow()" class="w-full p-5 bg-blue-600 rounded-2xl font-bold active:scale-90 transition-transform">
                SAVE CUSTOMER
            </button>
        </div>

        <div id="list" class="mt-8"></div>
    </div>

    <script>
        const DB = 'KHATA_V23_DATA';

        // സ്റ്റോറേജ് വർക്ക് ആകുന്നുണ്ടോ എന്ന് പരിശോധിക്കാൻ
        window.onload = function() {
            try {
                localStorage.setItem('test', '1');
                document.getElementById('debug_msg').innerText = "✅ Storage Ready";
                render();
            } catch(e) {
                document.getElementById('debug_msg').innerText = "❌ Storage Blocked! Please enable Cookies/Local Storage in Chrome settings.";
            }
        };

        function render() {
            const data = JSON.parse(localStorage.getItem(DB)) || [];
            const div = document.getElementById('list');
            div.innerHTML = '';
            data.forEach(item => {
                div.innerHTML += `<div class="bg-slate-800 p-4 rounded-xl mb-2 flex justify-between">
                    <b>${item.name}</b> <span>${item.phone}</span>
                </div>`;
            });
        }

        function saveNow() {
            const n = document.getElementById('name').value.trim();
            const p = document.getElementById('phone').value.trim();

            if(!n) { alert("Enter Name!"); return; }

            let data = JSON.parse(localStorage.getItem(DB)) || [];
            data.push({name: n, phone: p});
            
            try {
                localStorage.setItem(DB, JSON.stringify(data));
                document.getElementById('name').value = '';
                document.getElementById('phone').value = '';
                render();
                alert("✅ SUCCESS: " + n + " saved!");
            } catch(e) {
                alert("❌ ERROR: Could not save to memory.");
            }
        }
    </script>
</body>
</html>